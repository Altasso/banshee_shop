{% extends 'base.html' %}

{% block title %}–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - Clay Art{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h1>
            <a href="{% url 'user-create' %}" class="btn btn-primary">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            </a>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ({{ page_obj.paginator.count }})</h5>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                                <th>Email</th>
                                <th>–ò–º—è</th>
                                <th>–§–∞–º–∏–ª–∏—è</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user_item in users %}
                            <tr>
                                <td>{{ user_item.id }}</td>
                                <td>
                                    <strong>{{ user_item.username }}</strong>
                                    {% if user_item.is_superuser %}
                                    <span class="badge bg-danger ms-1">–ê–¥–º–∏–Ω</span>
                                    {% elif user_item.is_staff %}
                                    <span class="badge bg-warning ms-1">–ü–µ—Ä—Å–æ–Ω–∞–ª</span>
                                    {% endif %}
                                </td>
                                <td>{{ user_item.email|default:"‚Äî" }}</td>
                                <td>{{ user_item.first_name|default:"‚Äî" }}</td>
                                <td>{{ user_item.last_name|default:"‚Äî" }}</td>
                                <td>
                                    {% if user_item.is_active %}
                                    <span class="badge bg-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
                                    {% else %}
                                    <span class="badge bg-secondary">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>
                                    {% endif %}
                                </td>
                                <td>{{ user_item.date_joined|date:"d.m.Y" }}</td>
                                <td>
                                    <div class="btn-group" role="group">
                                        <a href="{% url 'user-detail' user_item.pk %}" 
                                           class="btn btn-sm btn-primary" 
                                           title="–ü—Ä–æ—Å–º–æ—Ç—Ä">
                                            üëÅÔ∏è
                                        </a>
                                        <a href="{% url 'user-update' user_item.pk %}" 
                                           class="btn btn-sm btn-warning" 
                                           title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                            ‚úèÔ∏è
                                        </a>
                                        <button 
                                            hx-delete="{% url 'user-delete' user_item.pk %}"
                                            hx-confirm="–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ user_item.username }}?"
                                            hx-target="closest tr"
                                            hx-swap="outerHTML swap:1s"
                                            class="btn btn-sm btn-danger"
                                            title="–£–¥–∞–ª–∏—Ç—å">
                                            üóëÔ∏è
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="8" class="text-center py-4">
                                    <p class="mb-0 text-muted">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Pagination -->
        {% if page_obj.has_other_pages %}
        <nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º" class="mt-4">
            <ul class="pagination justify-content-center">
                {% if page_obj.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?page=1">–ü–µ—Ä–≤–∞—è</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.previous_page_number }}">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
                </li>
                {% endif %}

                {% for num in page_obj.paginator.page_range %}
                    {% if page_obj.number == num %}
                    <li class="page-item active">
                        <span class="page-link">{{ num }}</span>
                    </li>
                    {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                    </li>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.next_page_number }}">–°–ª–µ–¥—É—é—â–∞—è</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">–ü–æ—Å–ª–µ–¥–Ω—è—è</a>
                </li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
    </div>
</div>
{% endblock %}