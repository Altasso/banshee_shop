{% extends 'base.html' %}

{% block title %}
    {% if form.instance.pk %}
        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ - Clay Art
    {% else %}
        –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ - Clay Art
    {% endif %}
{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="breadcrumb-item"><a href="{% url 'user-detail' request.user.pk %}">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
                <li class="breadcrumb-item"><a href="{% url 'address-list' %}">–ê–¥—Ä–µ—Å–∞</a></li>
                <li class="breadcrumb-item active">
                    {% if form.instance.pk %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ{% else %}–î–æ–±–∞–≤–ª–µ–Ω–∏–µ{% endif %}
                </li>
            </ol>
        </nav>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h3 class="mb-0">
                    {% if form.instance.pk %}
                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
                    {% else %}
                        üìç –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞
                    {% endif %}
                </h3>
            </div>
            <div class="card-body p-4">
                <p class="text-muted mb-4">
                    {% if form.instance.pk %}
                        –û–±–Ω–æ–≤–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–¥—Ä–µ—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏
                    {% else %}
                        –î–æ–±–∞–≤—å—Ç–µ –∞–¥—Ä–µ—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
                    {% endif %}
                </p>

                <form method="post" hx-post="{{ request.path }}" hx-target="this" hx-swap="outerHTML">
                    {% csrf_token %}
                    
                    {% if form.non_field_errors %}
                    <div class="alert alert-danger">
                        {{ form.non_field_errors }}
                    </div>
                    {% endif %}

                    <!-- Address Type & Full Name -->
                    <div class="row">
                        {% if form.address_type %}
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.address_type.id_for_label }}" class="form-label">
                                üè∑Ô∏è –¢–∏–ø –∞–¥—Ä–µ—Å–∞
                            </label>
                            {{ form.address_type }}
                            {% if form.address_type.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.address_type.errors }}
                            </div>
                            {% endif %}
                            <small class="form-text text-muted">–ù–∞–ø—Ä–∏–º–µ—Ä: –î–æ–º, –†–∞–±–æ—Ç–∞, –î–∞—á–∞</small>
                        </div>
                        {% endif %}

                        <div class="col-md-6 mb-3">
                            <label for="{{ form.full_name.id_for_label }}" class="form-label">
                                üë§ –ü–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—É—á–∞—Ç–µ–ª—è <span class="text-danger">*</span>
                            </label>
                            {{ form.full_name }}
                            {% if form.full_name.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.full_name.errors }}
                            </div>
                            {% endif %}
                        </div>
                    </div>

                    <hr class="my-4">
                    <h5 style="color: var(--moss-green);" class="mb-3">üìÆ –ê–¥—Ä–µ—Å</h5>

                    <!-- Country & City -->
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.country.id_for_label }}" class="form-label">
                                üåç –°—Ç—Ä–∞–Ω–∞ <span class="text-danger">*</span>
                            </label>
                            {{ form.country }}
                            {% if form.country.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.country.errors }}
                            </div>
                            {% endif %}
                        </div>

                        <div class="col-md-6 mb-3">
                            <label for="{{ form.city.id_for_label }}" class="form-label">
                                üèôÔ∏è –ì–æ—Ä–æ–¥ <span class="text-danger">*</span>
                            </label>
                            {{ form.city }}
                            {% if form.city.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.city.errors }}
                            </div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Postal Code & Region -->
                    <div class="row">
                        {% if form.postal_code %}
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.postal_code.id_for_label }}" class="form-label">
                                üì¨ –ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å
                            </label>
                            {{ form.postal_code }}
                            {% if form.postal_code.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.postal_code.errors }}
                            </div>
                            {% endif %}
                        </div>
                        {% endif %}

                        {% if form.region %}
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.region.id_for_label }}" class="form-label">
                                üó∫Ô∏è –†–µ–≥–∏–æ–Ω/–û–±–ª–∞—Å—Ç—å
                            </label>
                            {{ form.region }}
                            {% if form.region.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.region.errors }}
                            </div>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>

                    <!-- Address Line 1 -->
                    <div class="mb-3">
                        <label for="{{ form.address_line1.id_for_label }}" class="form-label">
                            üè† –ê–¥—Ä–µ—Å (—É–ª–∏—Ü–∞, –¥–æ–º) <span class="text-danger">*</span>
                        </label>
                        {{ form.address_line1 }}
                        {% if form.address_line1.errors %}
                        <div class="text-danger small mt-1">
                            {{ form.address_line1.errors }}
                        </div>
                        {% endif %}
                        <small class="form-text text-muted">–ù–∞–ø—Ä–∏–º–µ—Ä: —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10</small>
                    </div>

                    <!-- Address Line 2 -->
                    {% if form.address_line2 %}
                    <div class="mb-3">
                        <label for="{{ form.address_line2.id_for_label }}" class="form-label">
                            üè¢ –ö–≤–∞—Ä—Ç–∏—Ä–∞, –æ—Ñ–∏—Å, –∫–æ—Ä–ø—É—Å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                        </label>
                        {{ form.address_line2 }}
                        {% if form.address_line2.errors %}
                        <div class="text-danger small mt-1">
                            {{ form.address_line2.errors }}
                        </div>
                        {% endif %}
                        <small class="form-text text-muted">–ù–∞–ø—Ä–∏–º–µ—Ä: –∫–≤. 25, –∫–æ—Ä–ø. 2</small>
                    </div>
                    {% endif %}

                    <hr class="my-4">
                    <h5 style="color: var(--moss-green);" class="mb-3">üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</h5>

                    <!-- Phone -->
                    <div class="mb-3">
                        <label for="{{ form.phone.id_for_label }}" class="form-label">
                            üì± –¢–µ–ª–µ—Ñ–æ–Ω <span class="text-danger">*</span>
                        </label>
                        {{ form.phone }}
                        {% if form.phone.errors %}
                        <div class="text-danger small mt-1">
                            {{ form.phone.errors }}
                        </div>
                        {% endif %}
                        <small class="form-text text-muted">–î–ª—è —Å–≤—è–∑–∏ —Å –∫—É—Ä—å–µ—Ä–æ–º</small>
                    </div>

                    <!-- Notes -->
                    {% if form.notes %}
                    <div class="mb-3">
                        <label for="{{ form.notes.id_for_label }}" class="form-label">
                            üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è –∫—É—Ä—å–µ—Ä–∞
                        </label>
                        {{ form.notes }}
                        {% if form.notes.errors %}
                        <div class="text-danger small mt-1">
                            {{ form.notes.errors }}
                        </div>
                        {% endif %}
                        <small class="form-text text-muted">–ö–æ–¥ –¥–æ–º–æ—Ñ–æ–Ω–∞, —ç—Ç–∞–∂, –æ—Å–æ–±—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</small>
                    </div>
                    {% endif %}

                    <hr class="my-4">

                    <!-- Is Default -->
                    {% if form.is_default %}
                    <div class="mb-4">
                        <div class="card" style="background-color: var(--milk-white); border: 2px solid var(--grey-green);">
                            <div class="card-body">
                                <div class="form-check">
                                    {{ form.is_default }}
                                    <label class="form-check-label" for="{{ form.is_default.id_for_label }}">
                                        <strong>‚≠ê –°–¥–µ–ª–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º</strong>
                                        <br>
                                        <small class="text-muted">–≠—Ç–æ—Ç –∞–¥—Ä–µ—Å –±—É–¥–µ—Ç –≤—ã–±—Ä–∞–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞</small>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    <div class="d-flex gap-3">
                        <button type="submit" class="btn btn-primary flex-grow-1 btn-lg">
                            {% if form.instance.pk %}
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                            {% else %}
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å
                            {% endif %}
                        </button>
                        <a href="{% url 'address-list' %}" class="btn btn-secondary btn-lg">
                            ‚ùå –û—Ç–º–µ–Ω–∞
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Help Card -->
        {% if not form.instance.pk %}
        <div class="card mt-4" style="background: linear-gradient(135deg, rgba(90, 112, 80, 0.05), rgba(166, 124, 82, 0.05));">
            <div class="card-body">
                <h6 style="color: var(--moss-green);">üí° –°–æ–≤–µ—Ç</h6>
                <p class="mb-0">–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤: –¥–æ–º–∞—à–Ω–∏–π, —Ä–∞–±–æ—á–∏–π, –∞–¥—Ä–µ—Å –¥–ª—è –ø–æ–¥–∞—Ä–∫–æ–≤. –û–¥–∏–Ω –∏–∑ –Ω–∏—Ö –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–º.</p>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .form-control, .form-select, textarea {
        background-color: white;
    }
    
    .form-control:focus, .form-select:focus, textarea:focus {
        background-color: white;
    }
    
    .form-check-input:checked {
        background-color: var(--moss-green);
        border-color: var(--moss-green);
    }
    
    .form-check-input:focus {
        border-color: var(--moss-green);
        box-shadow: 0 0 0 0.2rem rgba(90, 112, 80, 0.25);
    }

    textarea.form-control {
        min-height: 80px;
    }
</style>
{% endblock %}